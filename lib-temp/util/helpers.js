import Vue from 'vue';
export function createSimpleFunctional(c, el = 'div', name) {
    return Vue.extend({
        name: name || c.replace(/__/g, '-'),
        functional: true,
        props: {
            tag: {
                type: String,
                default: el,
            },
        },
        render(h, { data, props, children }) {
            data.staticClass = (`${c} ${data.staticClass || ''}`).trim();
            return h(props.tag, data, children);
        },
    });
}
export function directiveConfig(binding, defaults = {}) {
    return {
        ...defaults,
        ...binding.modifiers,
        value: binding.arg,
        ...(binding.value || {}),
    };
}
export function addOnceEventListener(el, eventName, cb, options = false) {
    const once = (event) => {
        cb(event);
        el.removeEventListener(eventName, once, options);
    };
    el.addEventListener(eventName, once, options);
}
let passiveSupported = false;
try {
    if (typeof window !== 'undefined') {
        const testListenerOpts = Object.defineProperty({}, 'passive', {
            get: () => {
                passiveSupported = true;
            },
        });
        window.addEventListener('testListener', testListenerOpts, testListenerOpts);
        window.removeEventListener('testListener', testListenerOpts, testListenerOpts);
    }
}
catch (e) {
    console.warn(e);
} /* eslint-disable-line no-console */
export { passiveSupported };
export function addPassiveEventListener(el, event, cb, options) {
    el.addEventListener(event, cb, passiveSupported ? options : false);
}
export function getNestedValue(obj, path, fallback) {
    const last = path.length - 1;
    if (last < 0)
        return obj === undefined ? fallback : obj;
    for (let i = 0; i < last; i++) {
        if (obj == null) {
            return fallback;
        }
        obj = obj[path[i]];
    }
    if (obj == null)
        return fallback;
    return obj[path[last]] === undefined ? fallback : obj[path[last]];
}
export function deepEqual(a, b) {
    if (a === b)
        return true;
    if (a instanceof Date &&
        b instanceof Date &&
        a.getTime() !== b.getTime()) {
        // If the values are Date, compare them as timestamps
        return false;
    }
    if (a !== Object(a) || b !== Object(b)) {
        // If the values aren't objects, they were already checked for equality
        return false;
    }
    const props = Object.keys(a);
    if (props.length !== Object.keys(b).length) {
        // Different number of props, don't bother to check
        return false;
    }
    return props.every(p => deepEqual(a[p], b[p]));
}
export function getObjectValueByPath(obj, path, fallback) {
    // credit: http://stackoverflow.com/questions/6491463/accessing-nested-javascript-objects-with-string-key#comment55278413_6491621
    if (obj == null || !path || typeof path !== 'string')
        return fallback;
    if (obj[path] !== undefined)
        return obj[path];
    path = path.replace(/\[(\w+)\]/g, '.$1'); // convert indexes to properties
    path = path.replace(/^\./, ''); // strip a leading dot
    return getNestedValue(obj, path.split('.'), fallback);
}
export function getPropertyFromItem(item, property, fallback) {
    if (property == null)
        return item === undefined ? fallback : item;
    if (item !== Object(item))
        return fallback === undefined ? item : fallback;
    if (typeof property === 'string')
        return getObjectValueByPath(item, property, fallback);
    if (Array.isArray(property))
        return getNestedValue(item, property, fallback);
    if (typeof property !== 'function')
        return fallback;
    const value = property(item, fallback);
    return typeof value === 'undefined' ? fallback : value;
}
export function createRange(length) {
    return Array.from({ length }, (v, k) => k);
}
export function getZIndex(el) {
    if (!el || el.nodeType !== Node.ELEMENT_NODE)
        return 0;
    const index = +window.getComputedStyle(el).getPropertyValue('z-index');
    if (!index)
        return getZIndex(el.parentNode);
    return index;
}
const tagsToReplace = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
};
export function escapeHTML(str) {
    return str.replace(/[&<>]/g, tag => tagsToReplace[tag] || tag);
}
export function filterObjectOnKeys(obj, keys) {
    const filtered = {};
    for (let i = 0; i < keys.length; i++) {
        const key = keys[i];
        if (typeof obj[key] !== 'undefined') {
            filtered[key] = obj[key];
        }
    }
    return filtered;
}
export function convertToUnit(str, unit = 'px') {
    if (str == null || str === '') {
        return undefined;
    }
    else if (isNaN(+str)) {
        return String(str);
    }
    else {
        return `${Number(str)}${unit}`;
    }
}
export function kebabCase(str) {
    return (str || '').replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();
}
export function isObject(obj) {
    return obj !== null && typeof obj === 'object';
}
// KeyboardEvent.keyCode aliases
export const keyCodes = Object.freeze({
    enter: 13,
    tab: 9,
    delete: 46,
    esc: 27,
    space: 32,
    up: 38,
    down: 40,
    left: 37,
    right: 39,
    end: 35,
    home: 36,
    del: 46,
    backspace: 8,
    insert: 45,
    pageup: 33,
    pagedown: 34,
    shift: 16,
});
/**
 * This remaps internal names like '$cancel' or '$vuetify.icons.cancel'
 * to the current name or component for that icon.
 */
export function remapInternalIcon(vm, iconName) {
    // Look for custom component in the configuration
    const component = vm.$vuetify.icons.component;
    // Look for overrides
    if (iconName.startsWith('$')) {
        // Get the target icon name
        const iconPath = `$vuetify.icons.values.${iconName.split('$').pop().split('.').pop()}`;
        // Now look up icon indirection name,
        // e.g. '$vuetify.icons.values.cancel'
        const override = getObjectValueByPath(vm, iconPath, iconName);
        if (typeof override === 'string')
            iconName = override;
        else
            return override;
    }
    if (component == null) {
        return iconName;
    }
    return {
        component,
        props: {
            icon: iconName,
        },
    };
}
export function keys(o) {
    return Object.keys(o);
}
/**
 * Camelize a hyphen-delimited string.
 */
const camelizeRE = /-(\w)/g;
export const camelize = (str) => {
    return str.replace(camelizeRE, (_, c) => c ? c.toUpperCase() : '');
};
/**
 * Returns the set difference of B and A, i.e. the set of elements in B but not in A
 */
export function arrayDiff(a, b) {
    const diff = [];
    for (let i = 0; i < b.length; i++) {
        if (a.indexOf(b[i]) < 0)
            diff.push(b[i]);
    }
    return diff;
}
/**
 * Makes the first character of a string uppercase
 */
export function upperFirst(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
}
export function groupItems(items, groupBy, groupDesc) {
    const key = groupBy[0];
    const groups = [];
    let current;
    for (let i = 0; i < items.length; i++) {
        const item = items[i];
        const val = getObjectValueByPath(item, key, null);
        if (current !== val) {
            current = val;
            groups.push({
                name: val ?? '',
                items: [],
            });
        }
        groups[groups.length - 1].items.push(item);
    }
    return groups;
}
export function wrapInArray(v) { return v != null ? Array.isArray(v) ? v : [v] : []; }
export function sortItems(items, sortBy, sortDesc, locale, customSorters) {
    if (sortBy === null || !sortBy.length)
        return items;
    const stringCollator = new Intl.Collator(locale, { sensitivity: 'accent', usage: 'sort' });
    return items.sort((a, b) => {
        for (let i = 0; i < sortBy.length; i++) {
            const sortKey = sortBy[i];
            let sortA = getObjectValueByPath(a, sortKey);
            let sortB = getObjectValueByPath(b, sortKey);
            if (sortDesc[i]) {
                [sortA, sortB] = [sortB, sortA];
            }
            if (customSorters && customSorters[sortKey]) {
                const customResult = customSorters[sortKey](sortA, sortB);
                if (!customResult)
                    continue;
                return customResult;
            }
            // Check if both cannot be evaluated
            if (sortA === null && sortB === null) {
                continue;
            }
            // Dates should be compared numerically
            if (sortA instanceof Date && sortB instanceof Date) {
                return sortA.getTime() - sortB.getTime();
            }
            [sortA, sortB] = [sortA, sortB].map(s => (s || '').toString().toLocaleLowerCase());
            if (sortA !== sortB) {
                if (!isNaN(sortA) && !isNaN(sortB))
                    return Number(sortA) - Number(sortB);
                return stringCollator.compare(sortA, sortB);
            }
        }
        return 0;
    });
}
export function defaultFilter(value, search, item) {
    return value != null &&
        search != null &&
        typeof value !== 'boolean' &&
        value.toString().toLocaleLowerCase().indexOf(search.toLocaleLowerCase()) !== -1;
}
export function searchItems(items, search) {
    if (!search)
        return items;
    search = search.toString().toLowerCase();
    if (search.trim() === '')
        return items;
    return items.filter((item) => Object.keys(item).some(key => defaultFilter(getObjectValueByPath(item, key), search, item)));
}
/**
 * Returns:
 *  - 'normal' for old style slots - `<template slot="default">`
 *  - 'scoped' for old style scoped slots (`<template slot="default" slot-scope="data">`) or bound v-slot (`#default="data"`)
 *  - 'v-slot' for unbound v-slot (`#default`) - only if the third param is true, otherwise counts as scoped
 */
export function getSlotType(vm, name, split) {
    if (vm.$slots.hasOwnProperty(name) && vm.$scopedSlots.hasOwnProperty(name) && vm.$scopedSlots[name].name) {
        return split ? 'v-slot' : 'scoped';
    }
    if (vm.$slots.hasOwnProperty(name))
        return 'normal';
    if (vm.$scopedSlots.hasOwnProperty(name))
        return 'scoped';
}
export function debounce(fn, delay) {
    let timeoutId = 0;
    return (...args) => {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => fn(...args), delay);
    };
}
export function throttle(fn, limit) {
    let throttling = false;
    return (...args) => {
        if (!throttling) {
            throttling = true;
            setTimeout(() => throttling = false, limit);
            return fn(...args);
        }
    };
}
export function getPrefixedScopedSlots(prefix, scopedSlots) {
    return Object.keys(scopedSlots).filter(k => k.startsWith(prefix)).reduce((obj, k) => {
        obj[k.replace(prefix, '')] = scopedSlots[k];
        return obj;
    }, {});
}
export function getSlot(vm, name = 'default', data, optional = false) {
    if (vm.$scopedSlots.hasOwnProperty(name)) {
        return vm.$scopedSlots[name](data instanceof Function ? data() : data);
    }
    else if (vm.$slots.hasOwnProperty(name) && (!data || optional)) {
        return vm.$slots[name];
    }
    return undefined;
}
export function clamp(value, min = 0, max = 1) {
    return Math.max(min, Math.min(max, value));
}
export function padEnd(str, length, char = '0') {
    return str + char.repeat(Math.max(0, length - str.length));
}
export function chunk(str, size = 1) {
    const chunked = [];
    let index = 0;
    while (index < str.length) {
        chunked.push(str.substr(index, size));
        index += size;
    }
    return chunked;
}
export function humanReadableFileSize(bytes, binary = false) {
    const base = binary ? 1024 : 1000;
    if (bytes < base) {
        return `${bytes} B`;
    }
    const prefix = binary ? ['Ki', 'Mi', 'Gi'] : ['k', 'M', 'G'];
    let unit = -1;
    while (Math.abs(bytes) >= base && unit < prefix.length - 1) {
        bytes /= base;
        ++unit;
    }
    return `${bytes.toFixed(1)} ${prefix[unit]}B`;
}
export function camelizeObjectKeys(obj) {
    if (!obj)
        return {};
    return Object.keys(obj).reduce((o, key) => {
        o[camelize(key)] = obj[key];
        return o;
    }, {});
}
export function mergeDeep(source = {}, target = {}) {
    for (const key in target) {
        const sourceProperty = source[key];
        const targetProperty = target[key];
        // Only continue deep merging if
        // both properties are objects
        if (isObject(sourceProperty) &&
            isObject(targetProperty)) {
            source[key] = mergeDeep(sourceProperty, targetProperty);
            continue;
        }
        source[key] = targetProperty;
    }
    return source;
}
export function fillArray(length, obj) {
    return Array(length).fill(obj);
}
/**  Polyfill for Event.prototype.composedPath */
export function composedPath(e) {
    if (e.composedPath)
        return e.composedPath();
    const path = [];
    let el = e.target;
    while (el) {
        path.push(el);
        if (el.tagName === 'HTML') {
            path.push(document);
            path.push(window);
            return path;
        }
        el = el.parentElement;
    }
    return path;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVscGVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL2hlbHBlcnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxHQUFHLE1BQU0sS0FBSyxDQUFBO0FBS3JCLE1BQU0sVUFBVSxzQkFBc0IsQ0FDcEMsQ0FBUyxFQUNULEVBQUUsR0FBRyxLQUFLLEVBQ1YsSUFBYTtJQUViLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQztRQUNoQixJQUFJLEVBQUUsSUFBSSxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQztRQUVuQyxVQUFVLEVBQUUsSUFBSTtRQUVoQixLQUFLLEVBQUU7WUFDTCxHQUFHLEVBQUU7Z0JBQ0gsSUFBSSxFQUFFLE1BQU07Z0JBQ1osT0FBTyxFQUFFLEVBQUU7YUFDWjtTQUNGO1FBRUQsTUFBTSxDQUFFLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFO1lBQ2xDLElBQUksQ0FBQyxXQUFXLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxJQUFJLENBQUMsV0FBVyxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUE7WUFFNUQsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsUUFBUSxDQUFDLENBQUE7UUFDckMsQ0FBQztLQUNGLENBQUMsQ0FBQTtBQUNKLENBQUM7QUFHRCxNQUFNLFVBQVUsZUFBZSxDQUFFLE9BQXNCLEVBQUUsUUFBUSxHQUFHLEVBQUU7SUFDcEUsT0FBTztRQUNMLEdBQUcsUUFBUTtRQUNYLEdBQUcsT0FBTyxDQUFDLFNBQVM7UUFDcEIsS0FBSyxFQUFFLE9BQU8sQ0FBQyxHQUFHO1FBQ2xCLEdBQUcsQ0FBQyxPQUFPLENBQUMsS0FBSyxJQUFJLEVBQUUsQ0FBQztLQUN6QixDQUFBO0FBQ0gsQ0FBQztBQUVELE1BQU0sVUFBVSxvQkFBb0IsQ0FDbEMsRUFB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QUFJLENBQUMsQ0FBQyxZQUFZO1FBQUUsT0FBTyxDQUFDLENBQUMsWUFBWSxFQUFFLENBQUE7SUFFM0MsTUFBTSxJQUFJLEdBQUcsRUFBRSxDQUFBO0lBQ2YsSUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFDLE1BQWlCLENBQUE7SUFFNUIsT0FBTyxFQUFFLEVBQUU7UUFDVCxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFBO1FBRWIsSUFBSSxFQUFFLENBQUMsT0FBTyxLQUFLLE1BQU0sRUFBRTtZQUN6QixJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFBO1lBQ25CLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUE7WUFFakIsT0FBTyxJQUFJLENBQUE7U0FDWjtRQUVELEVBQUUsR0FBRyxFQUFFLENBQUMsYUFBYyxDQUFBO0tBQ3ZCO0lBQ0QsT0FBTyxJQUFJLENBQUE7QUFDYixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFZ1ZSBmcm9tICd2dWUnXG5pbXBvcnQgeyBWTm9kZSwgVk5vZGVEaXJlY3RpdmUgfSBmcm9tICd2dWUvdHlwZXMnXG5pbXBvcnQgeyBWdWV0aWZ5SWNvbiB9IGZyb20gJ3Z1ZXRpZnkvdHlwZXMvc2VydmljZXMvaWNvbnMnXG5pbXBvcnQgeyBEYXRhVGFibGVDb21wYXJlRnVuY3Rpb24sIFNlbGVjdEl0ZW1LZXksIEl0ZW1Hcm91cCB9IGZyb20gJ3Z1ZXRpZnkvdHlwZXMnXG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTaW1wbGVGdW5jdGlvbmFsIChcbiAgYzogc3RyaW5nLFxuICBlbCA9ICdkaXYnLFxuICBuYW1lPzogc3RyaW5nXG4pIHtcbiAgcmV0dXJuIFZ1ZS5leHRlbmQoe1xuICAgIG5hbWU6IG5hbWUgfHwgYy5yZXBsYWNlKC9fXy9nLCAnLScpLFxuXG4gICAgZnVuY3Rpb25hbDogdHJ1ZSxcblxuICAgIHByb3BzOiB7XG4gICAgICB0YWc6IHtcbiAgICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgICBkZWZhdWx0OiBlbCxcbiAgICAgIH0sXG4gICAgfSxcblxuICAgIHJlbmRlciAoaCwgeyBkYXRhLCBwcm9wcywgY2hpbGRyZW4gfSk6IFZOb2RlIHtcbiAgICAgIGRhdGEuc3RhdGljQ2xhc3MgPSAoYCR7Y30gJHtkYXRhLnN0YXRpY0NsYXNzIHx8ICcnfWApLnRyaW0oKVxuXG4gICAgICByZXR1cm4gaChwcm9wcy50YWcsIGRhdGEsIGNoaWxkcmVuKVxuICAgIH0sXG4gIH0pXG59XG5cbmV4cG9ydCB0eXBlIEJpbmRpbmdDb25maWcgPSBQaWNrPFZOb2RlRGlyZWN0aXZlLCAnYXJnJyB8ICdtb2RpZmllcnMnIHwgJ3ZhbHVlJz5cbmV4cG9ydCBmdW5jdGlvbiBkaXJlY3RpdmVDb25maWcgKGJpbmRpbmc6IEJpbmRpbmdDb25maWcsIGRlZmF1bHRzID0ge30pOiBWTm9kZURpcmVjdGl2ZSB7XG4gIHJldHVybiB7XG4gICAgLi4uZGVmYXVsdHMsXG4gICAgLi4uYmluZGluZy5tb2RpZmllcnMsXG4gICAgdmFsdWU6IGJpbmRpbmcuYXJnLFxuICAgIC4uLihiaW5kaW5nLnZhbHVlIHx8IHt9KSxcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYWRkT25jZUV2ZW50TGlzdGVuZXIgKFxuICBlbDogRXZlbnRUYXJnZXQsXG4gIGV2ZW50TmFtZTogc3RyaW5nLFxuICBjYjogKGV2ZW50OiBFdmVudCkgPT4gdm9pZCxcbiAgb3B0aW9uczogYm9vbGVhbiB8IEFkZEV2ZW50TGlzdGVuZXJPcHRpb25zID0gZmFsc2Vcbik6IHZvaWQge1xuICBjb25zdCBvbmNlID0gKGV2ZW50OiBFdmVudCkgPT4ge1xuICAgIGNiKGV2ZW50KVxuICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBvbmNlLCBvcHRpb25zKVxuICB9XG5cbiAgZWwuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIG9uY2UsIG9wdGlvbnMpXG59XG5cbmxldCBwYXNzaXZlU3VwcG9ydGVkID0gZmFsc2VcbnRyeSB7XG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIGNvbnN0IHRlc3RMaXN0ZW5lck9wdHMgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdwYXNzaXZlJywge1xuICAgICAgZ2V0OiAoKSA9PiB7XG4gICAgICAgIHBhc3NpdmVTdXBwb3J0ZWQgPSB0cnVlXG4gICAgICB9LFxuICAgIH0pXG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndGVzdExpc3RlbmVyJywgdGVzdExpc3RlbmVyT3B0cywgdGVzdExpc3RlbmVyT3B0cylcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndGVzdExpc3RlbmVyJywgdGVzdExpc3RlbmVyT3B0cywgdGVzdExpc3RlbmVyT3B0cylcbiAgfVxufSBjYXRjaCAoZSkgeyBjb25zb2xlLndhcm4oZSkgfSAvKiBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGUgKi9cbmV4cG9ydCB7IHBhc3NpdmVTdXBwb3J0ZWQgfVxuXG5leHBvcnQgZnVuY3Rpb24gYWRkUGFzc2l2ZUV2ZW50TGlzdGVuZXIgKFxuICBlbDogRXZlbnRUYXJnZXQsXG4gIGV2ZW50OiBzdHJpbmcsXG4gIGNiOiBFdmVudEhhbmRsZXJOb25OdWxsIHwgKCgpID0+IHZvaWQpLFxuICBvcHRpb25zOiB7fVxuKTogdm9pZCB7XG4gIGVsLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGNiLCBwYXNzaXZlU3VwcG9ydGVkID8gb3B0aW9ucyA6IGZhbHNlKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TmVzdGVkVmFsdWUgKG9iajogYW55LCBwYXRoOiAoc3RyaW5nIHwgbnVtYmVyKVtdLCBmYWxsYmFjaz86IGFueSk6IGFueSB7XG4gIGNvbnN0IGxhc3QgPSBwYXRoLmxlbmd0aCAtIDFcblxuICBpZiAobGFzdCA8IDApIHJldHVybiBvYmogPT09IHVuZGVmaW5lZCA/IGZhbGxiYWNrIDogb2JqXG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsYXN0OyBpKyspIHtcbiAgICBpZiAob2JqID09IG51bGwpIHtcbiAgICAgIHJldHVybiBmYWxsYmFja1xuICAgIH1cbiAgICBvYmogPSBvYmpbcGF0aFtpXV1cbiAgfVxuXG4gIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIGZhbGxiYWNrXG5cbiAgcmV0dXJuIG9ialtwYXRoW2xhc3RdXSA9PT0gdW5kZWZpbmVkID8gZmFsbGJhY2sgOiBvYmpbcGF0aFtsYXN0XV1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlZXBFcXVhbCAoYTogYW55LCBiOiBhbnkpOiBib29sZWFuIHtcbiAgaWYgKGEgPT09IGIpIHJldHVybiB0cnVlXG5cbiAgaWYgKFxuICAgIGEgaW5zdGFuY2VvZiBEYXRlICYmXG4gICAgYiBpbnN0YW5jZW9mIERhdGUgJiZcbiAgICBhLmdldFRpbWUoKSAhPT0gYi5nZXRUaW1lKClcbiAgKSB7XG4gICAgLy8gSWYgdGhlIHZhbHVlcyBhcmUgRGF0ZSwgY29tcGFyZSB0aGVtIGFzIHRpbWVzdGFtcHNcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIGlmIChhICE9PSBPYmplY3QoYSkgfHwgYiAhPT0gT2JqZWN0KGIpKSB7XG4gICAgLy8gSWYgdGhlIHZhbHVlcyBhcmVuJ3Qgb2JqZWN0cywgdGhleSB3ZXJlIGFscmVhZHkgY2hlY2tlZCBmb3IgZXF1YWxpdHlcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIGNvbnN0IHByb3BzID0gT2JqZWN0LmtleXMoYSlcblxuICBpZiAocHJvcHMubGVuZ3RoICE9PSBPYmplY3Qua2V5cyhiKS5sZW5ndGgpIHtcbiAgICAvLyBEaWZmZXJlbnQgbnVtYmVyIG9mIHByb3BzLCBkb24ndCBib3RoZXIgdG8gY2hlY2tcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIHJldHVybiBwcm9wcy5ldmVyeShwID0+IGRlZXBFcXVhbChhW3BdLCBiW3BdKSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE9iamVjdFZhbHVlQnlQYXRoIChvYmo6IGFueSwgcGF0aDogc3RyaW5nLCBmYWxsYmFjaz86IGFueSk6IGFueSB7XG4gIC8vIGNyZWRpdDogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy82NDkxNDYzL2FjY2Vzc2luZy1uZXN0ZWQtamF2YXNjcmlwdC1vYmplY3RzLXdpdGgtc3RyaW5nLWtleSNjb21tZW50NTUyNzg0MTNfNjQ5MTYyMVxuICBpZiAob2JqID09IG51bGwgfHwgIXBhdGggfHwgdHlwZW9mIHBhdGggIT09ICdzdHJpbmcnKSByZXR1cm4gZmFsbGJhY2tcbiAgaWYgKG9ialtwYXRoXSAhPT0gdW5kZWZpbmVkKSByZXR1cm4gb2JqW3BhdGhdXG4gIHBhdGggPSBwYXRoLnJlcGxhY2UoL1xcWyhcXHcrKVxcXS9nLCAnLiQxJykgLy8gY29udmVydCBpbmRleGVzIHRvIHByb3BlcnRpZXNcbiAgcGF0aCA9IHBhdGgucmVwbGFjZSgvXlxcLi8sICcnKSAvLyBzdHJpcCBhIGxlYWRpbmcgZG90XG4gIHJldHVybiBnZXROZXN0ZWRWYWx1ZShvYmosIHBhdGguc3BsaXQoJy4nKSwgZmFsbGJhY2spXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQcm9wZXJ0eUZyb21JdGVtIChcbiAgaXRlbTogb2JqZWN0LFxuICBwcm9wZXJ0eTogU2VsZWN0SXRlbUtleSxcbiAgZmFsbGJhY2s/OiBhbnlcbik6IGFueSB7XG4gIGlmIChwcm9wZXJ0eSA9PSBudWxsKSByZXR1cm4gaXRlbSA9PT0gdW5kZWZpbmVkID8gZmFsbGJhY2sgOiBpdGVtXG5cbiAgaWYgKGl0ZW0gIT09IE9iamVjdChpdGVtKSkgcmV0dXJuIGZhbGxiYWNrID09PSB1bmRlZmluZWQgPyBpdGVtIDogZmFsbGJhY2tcblxuICBpZiAodHlwZW9mIHByb3BlcnR5ID09PSAnc3RyaW5nJykgcmV0dXJuIGdldE9iamVjdFZhbHVlQnlQYXRoKGl0ZW0sIHByb3BlcnR5LCBmYWxsYmFjaylcblxuICBpZiAoQXJyYXkuaXNBcnJheShwcm9wZXJ0eSkpIHJldHVybiBnZXROZXN0ZWRWYWx1ZShpdGVtLCBwcm9wZXJ0eSwgZmFsbGJhY2spXG5cbiAgaWYgKHR5cGVvZiBwcm9wZXJ0eSAhPT0gJ2Z1bmN0aW9uJykgcmV0dXJuIGZhbGxiYWNrXG5cbiAgY29uc3QgdmFsdWUgPSBwcm9wZXJ0eShpdGVtLCBmYWxsYmFjaylcblxuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJyA/IGZhbGxiYWNrIDogdmFsdWVcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVJhbmdlIChsZW5ndGg6IG51bWJlcik6IG51bWJlcltdIHtcbiAgcmV0dXJuIEFycmF5LmZyb20oeyBsZW5ndGggfSwgKHYsIGspID0+IGspXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRaSW5kZXggKGVsPzogRWxlbWVudCB8IG51bGwpOiBudW1iZXIge1xuICBpZiAoIWVsIHx8IGVsLm5vZGVUeXBlICE9PSBOb2RlLkVMRU1FTlRfTk9ERSkgcmV0dXJuIDBcblxuICBjb25zdCBpbmRleCA9ICt3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbCkuZ2V0UHJvcGVydHlWYWx1ZSgnei1pbmRleCcpXG5cbiAgaWYgKCFpbmRleCkgcmV0dXJuIGdldFpJbmRleChlbC5wYXJlbnROb2RlIGFzIEVsZW1lbnQpXG4gIHJldHVybiBpbmRleFxufVxuXG5jb25zdCB0YWdzVG9SZXBsYWNlID0ge1xuICAnJic6ICcmYW1wOycsXG4gICc8JzogJyZsdDsnLFxuICAnPic6ICcmZ3Q7Jyxcbn0gYXMgYW55XG5cbmV4cG9ydCBmdW5jdGlvbiBlc2NhcGVIVE1MIChzdHI6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBzdHIucmVwbGFjZSgvWyY8Pl0vZywgdGFnID0+IHRhZ3NUb1JlcGxhY2VbdGFnXSB8fCB0YWcpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJPYmplY3RPbktleXM8VCwgSyBleHRlbmRzIGtleW9mIFQ+IChvYmo6IFQsIGtleXM6IEtbXSk6IHsgW04gaW4gS106IFRbTl0gfSB7XG4gIGNvbnN0IGZpbHRlcmVkID0ge30gYXMgeyBbTiBpbiBLXTogVFtOXSB9XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3Qga2V5ID0ga2V5c1tpXVxuICAgIGlmICh0eXBlb2Ygb2JqW2tleV0gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBmaWx0ZXJlZFtrZXldID0gb2JqW2tleV1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gZmlsdGVyZWRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRUb1VuaXQgKHN0cjogc3RyaW5nIHwgbnVtYmVyIHwgbnVsbCB8IHVuZGVmaW5lZCwgdW5pdCA9ICdweCcpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICBpZiAoc3RyID09IG51bGwgfHwgc3RyID09PSAnJykge1xuICAgIHJldHVybiB1bmRlZmluZWRcbiAgfSBlbHNlIGlmIChpc05hTigrc3RyISkpIHtcbiAgICByZXR1cm4gU3RyaW5nKHN0cilcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYCR7TnVtYmVyKHN0cil9JHt1bml0fWBcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24ga2ViYWJDYXNlIChzdHI6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiAoc3RyIHx8ICcnKS5yZXBsYWNlKC8oW2Etel0pKFtBLVpdKS9nLCAnJDEtJDInKS50b0xvd2VyQ2FzZSgpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc09iamVjdCAob2JqOiBhbnkpOiBvYmogaXMgb2JqZWN0IHtcbiAgcmV0dXJuIG9iaiAhPT0gbnVsbCAmJiB0eXBlb2Ygb2JqID09PSAnb2JqZWN0J1xufVxuXG4vLyBLZXlib2FyZEV2ZW50LmtleUNvZGUgYWxpYXNlc1xuZXhwb3J0IGNvbnN0IGtleUNvZGVzID0gT2JqZWN0LmZyZWV6ZSh7XG4gIGVudGVyOiAxMyxcbiAgdGFiOiA5LFxuICBkZWxldGU6IDQ2LFxuICBlc2M6IDI3LFxuICBzcGFjZTogMzIsXG4gIHVwOiAzOCxcbiAgZG93bjogNDAsXG4gIGxlZnQ6IDM3LFxuICByaWdodDogMzksXG4gIGVuZDogMzUsXG4gIGhvbWU6IDM2LFxuICBkZWw6IDQ2LFxuICBiYWNrc3BhY2U6IDgsXG4gIGluc2VydDogNDUsXG4gIHBhZ2V1cDogMzMsXG4gIHBhZ2Vkb3duOiAzNCxcbiAgc2hpZnQ6IDE2LFxufSlcblxuLyoqXG4gKiBUaGlzIHJlbWFwcyBpbnRlcm5hbCBuYW1lcyBsaWtlICckY2FuY2VsJyBvciAnJHZ1ZXRpZnkuaWNvbnMuY2FuY2VsJ1xuICogdG8gdGhlIGN1cnJlbnQgbmFtZSBvciBjb21wb25lbnQgZm9yIHRoYXQgaWNvbi5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbWFwSW50ZXJuYWxJY29uICh2bTogVnVlLCBpY29uTmFtZTogc3RyaW5nKTogVnVldGlmeUljb24ge1xuICAvLyBMb29rIGZvciBjdXN0b20gY29tcG9uZW50IGluIHRoZSBjb25maWd1cmF0aW9uXG4gIGNvbnN0IGNvbXBvbmVudCA9IHZtLiR2dWV0aWZ5Lmljb25zLmNvbXBvbmVudFxuXG4gIC8vIExvb2sgZm9yIG92ZXJyaWRlc1xuICBpZiAoaWNvbk5hbWUuc3RhcnRzV2l0aCgnJCcpKSB7XG4gICAgLy8gR2V0IHRoZSB0YXJnZXQgaWNvbiBuYW1lXG4gICAgY29uc3QgaWNvblBhdGggPSBgJHZ1ZXRpZnkuaWNvbnMudmFsdWVzLiR7aWNvbk5hbWUuc3BsaXQoJyQnKS5wb3AoKSEuc3BsaXQoJy4nKS5wb3AoKX1gXG5cbiAgICAvLyBOb3cgbG9vayB1cCBpY29uIGluZGlyZWN0aW9uIG5hbWUsXG4gICAgLy8gZS5nLiAnJHZ1ZXRpZnkuaWNvbnMudmFsdWVzLmNhbmNlbCdcbiAgICBjb25zdCBvdmVycmlkZSA9IGdldE9iamVjdFZhbHVlQnlQYXRoKHZtLCBpY29uUGF0aCwgaWNvbk5hbWUpXG5cbiAgICBpZiAodHlwZW9mIG92ZXJyaWRlID09PSAnc3RyaW5nJykgaWNvbk5hbWUgPSBvdmVycmlkZVxuICAgIGVsc2UgcmV0dXJuIG92ZXJyaWRlXG4gIH1cblxuICBpZiAoY29tcG9uZW50ID09IG51bGwpIHtcbiAgICByZXR1cm4gaWNvbk5hbWVcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgY29tcG9uZW50LFxuICAgIHByb3BzOiB7XG4gICAgICBpY29uOiBpY29uTmFtZSxcbiAgICB9LFxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBrZXlzPE8+IChvOiBPKSB7XG4gIHJldHVybiBPYmplY3Qua2V5cyhvKSBhcyAoa2V5b2YgTylbXVxufVxuXG4vKipcbiAqIENhbWVsaXplIGEgaHlwaGVuLWRlbGltaXRlZCBzdHJpbmcuXG4gKi9cbmNvbnN0IGNhbWVsaXplUkUgPSAvLShcXHcpL2dcbmV4cG9ydCBjb25zdCBjYW1lbGl6ZSA9IChzdHI6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gIHJldHVybiBzdHIucmVwbGFjZShjYW1lbGl6ZVJFLCAoXywgYykgPT4gYyA/IGMudG9VcHBlckNhc2UoKSA6ICcnKVxufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHNldCBkaWZmZXJlbmNlIG9mIEIgYW5kIEEsIGkuZS4gdGhlIHNldCBvZiBlbGVtZW50cyBpbiBCIGJ1dCBub3QgaW4gQVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXJyYXlEaWZmIChhOiBhbnlbXSwgYjogYW55W10pOiBhbnlbXSB7XG4gIGNvbnN0IGRpZmY6IGFueVtdID0gW11cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBiLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKGEuaW5kZXhPZihiW2ldKSA8IDApIGRpZmYucHVzaChiW2ldKVxuICB9XG4gIHJldHVybiBkaWZmXG59XG5cbi8qKlxuICogTWFrZXMgdGhlIGZpcnN0IGNoYXJhY3RlciBvZiBhIHN0cmluZyB1cHBlcmNhc2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVwcGVyRmlyc3QgKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuIHN0ci5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0ci5zbGljZSgxKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ3JvdXBJdGVtczxUIGV4dGVuZHMgYW55ID0gYW55PiAoXG4gIGl0ZW1zOiBUW10sXG4gIGdyb3VwQnk6IHN0cmluZ1tdLFxuICBncm91cERlc2M6IGJvb2xlYW5bXVxuKTogSXRlbUdyb3VwPFQ+W10ge1xuICBjb25zdCBrZXkgPSBncm91cEJ5WzBdXG4gIGNvbnN0IGdyb3VwczogSXRlbUdyb3VwPFQ+W10gPSBbXVxuICBsZXQgY3VycmVudFxuICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgaXRlbSA9IGl0ZW1zW2ldXG4gICAgY29uc3QgdmFsID0gZ2V0T2JqZWN0VmFsdWVCeVBhdGgoaXRlbSwga2V5LCBudWxsKVxuICAgIGlmIChjdXJyZW50ICE9PSB2YWwpIHtcbiAgICAgIGN1cnJlbnQgPSB2YWxcbiAgICAgIGdyb3Vwcy5wdXNoKHtcbiAgICAgICAgbmFtZTogdmFsID8/ICcnLFxuICAgICAgICBpdGVtczogW10sXG4gICAgICB9KVxuICAgIH1cbiAgICBncm91cHNbZ3JvdXBzLmxlbmd0aCAtIDFdLml0ZW1zLnB1c2goaXRlbSlcbiAgfVxuICByZXR1cm4gZ3JvdXBzXG59XG5cbmV4cG9ydCBmdW5jdGlvbiB3cmFwSW5BcnJheTxUPiAodjogVCB8IFRbXSB8IG51bGwgfCB1bmRlZmluZWQpOiBUW10geyByZXR1cm4gdiAhPSBudWxsID8gQXJyYXkuaXNBcnJheSh2KSA/IHYgOiBbdl0gOiBbXSB9XG5cbmV4cG9ydCBmdW5jdGlvbiBzb3J0SXRlbXM8VCBleHRlbmRzIGFueSA9IGFueT4gKFxuICBpdGVtczogVFtdLFxuICBzb3J0Qnk6IHN0cmluZ1tdLFxuICBzb3J0RGVzYzogYm9vbGVhbltdLFxuICBsb2NhbGU6IHN0cmluZyxcbiAgY3VzdG9tU29ydGVycz86IFJlY29yZDxzdHJpbmcsIERhdGFUYWJsZUNvbXBhcmVGdW5jdGlvbjxUPj5cbik6IFRbXSB7XG4gIGlmIChzb3J0QnkgPT09IG51bGwgfHwgIXNvcnRCeS5sZW5ndGgpIHJldHVybiBpdGVtc1xuICBjb25zdCBzdHJpbmdDb2xsYXRvciA9IG5ldyBJbnRsLkNvbGxhdG9yKGxvY2FsZSwgeyBzZW5zaXRpdml0eTogJ2FjY2VudCcsIHVzYWdlOiAnc29ydCcgfSlcblxuICByZXR1cm4gaXRlbXMuc29ydCgoYSwgYikgPT4ge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc29ydEJ5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBzb3J0S2V5ID0gc29ydEJ5W2ldXG5cbiAgICAgIGxldCBzb3J0QSA9IGdldE9iamVjdFZhbHVlQnlQYXRoKGEsIHNvcnRLZXkpXG4gICAgICBsZXQgc29ydEIgPSBnZXRPYmplY3RWYWx1ZUJ5UGF0aChiLCBzb3J0S2V5KVxuXG4gICAgICBpZiAoc29ydERlc2NbaV0pIHtcbiAgICAgICAgW3NvcnRBLCBzb3J0Ql0gPSBbc29ydEIsIHNvcnRBXVxuICAgICAgfVxuXG4gICAgICBpZiAoY3VzdG9tU29ydGVycyAmJiBjdXN0b21Tb3J0ZXJzW3NvcnRLZXldKSB7XG4gICAgICAgIGNvbnN0IGN1c3RvbVJlc3VsdCA9IGN1c3RvbVNvcnRlcnNbc29ydEtleV0oc29ydEEsIHNvcnRCKVxuXG4gICAgICAgIGlmICghY3VzdG9tUmVzdWx0KSBjb250aW51ZVxuXG4gICAgICAgIHJldHVybiBjdXN0b21SZXN1bHRcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgYm90aCBjYW5ub3QgYmUgZXZhbHVhdGVkXG4gICAgICBpZiAoc29ydEEgPT09IG51bGwgJiYgc29ydEIgPT09IG51bGwpIHtcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgLy8gRGF0ZXMgc2hvdWxkIGJlIGNvbXBhcmVkIG51bWVyaWNhbGx5XG4gICAgICBpZiAoc29ydEEgaW5zdGFuY2VvZiBEYXRlICYmIHNvcnRCIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICByZXR1cm4gc29ydEEuZ2V0VGltZSgpIC0gc29ydEIuZ2V0VGltZSgpXG4gICAgICB9XG5cbiAgICAgIFtzb3J0QSwgc29ydEJdID0gW3NvcnRBLCBzb3J0Ql0ubWFwKHMgPT4gKHMgfHwgJycpLnRvU3RyaW5nKCkudG9Mb2NhbGVMb3dlckNhc2UoKSlcblxuICAgICAgaWYgKHNvcnRBICE9PSBzb3J0Qikge1xuICAgICAgICBpZiAoIWlzTmFOKHNvcnRBKSAmJiAhaXNOYU4oc29ydEIpKSByZXR1cm4gTnVtYmVyKHNvcnRBKSAtIE51bWJlcihzb3J0QilcbiAgICAgICAgcmV0dXJuIHN0cmluZ0NvbGxhdG9yLmNvbXBhcmUoc29ydEEsIHNvcnRCKVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAwXG4gIH0pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWZhdWx0RmlsdGVyICh2YWx1ZTogYW55LCBzZWFyY2g6IHN0cmluZyB8IG51bGwsIGl0ZW06IGFueSkge1xuICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJlxuICAgIHNlYXJjaCAhPSBudWxsICYmXG4gICAgdHlwZW9mIHZhbHVlICE9PSAnYm9vbGVhbicgJiZcbiAgICB2YWx1ZS50b1N0cmluZygpLnRvTG9jYWxlTG93ZXJDYXNlKCkuaW5kZXhPZihzZWFyY2gudG9Mb2NhbGVMb3dlckNhc2UoKSkgIT09IC0xXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZWFyY2hJdGVtczxUIGV4dGVuZHMgYW55ID0gYW55PiAoaXRlbXM6IFRbXSwgc2VhcmNoOiBzdHJpbmcpOiBUW10ge1xuICBpZiAoIXNlYXJjaCkgcmV0dXJuIGl0ZW1zXG4gIHNlYXJjaCA9IHNlYXJjaC50b1N0cmluZygpLnRvTG93ZXJDYXNlKClcbiAgaWYgKHNlYXJjaC50cmltKCkgPT09ICcnKSByZXR1cm4gaXRlbXNcblxuICByZXR1cm4gaXRlbXMuZmlsdGVyKChpdGVtOiBhbnkpID0+IE9iamVjdC5rZXlzKGl0ZW0pLnNvbWUoa2V5ID0+IGRlZmF1bHRGaWx0ZXIoZ2V0T2JqZWN0VmFsdWVCeVBhdGgoaXRlbSwga2V5KSwgc2VhcmNoLCBpdGVtKSkpXG59XG5cbi8qKlxuICogUmV0dXJuczpcbiAqICAtICdub3JtYWwnIGZvciBvbGQgc3R5bGUgc2xvdHMgLSBgPHRlbXBsYXRlIHNsb3Q9XCJkZWZhdWx0XCI+YFxuICogIC0gJ3Njb3BlZCcgZm9yIG9sZCBzdHlsZSBzY29wZWQgc2xvdHMgKGA8dGVtcGxhdGUgc2xvdD1cImRlZmF1bHRcIiBzbG90LXNjb3BlPVwiZGF0YVwiPmApIG9yIGJvdW5kIHYtc2xvdCAoYCNkZWZhdWx0PVwiZGF0YVwiYClcbiAqICAtICd2LXNsb3QnIGZvciB1bmJvdW5kIHYtc2xvdCAoYCNkZWZhdWx0YCkgLSBvbmx5IGlmIHRoZSB0aGlyZCBwYXJhbSBpcyB0cnVlLCBvdGhlcndpc2UgY291bnRzIGFzIHNjb3BlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2xvdFR5cGU8VCBleHRlbmRzIGJvb2xlYW4gPSBmYWxzZT4gKHZtOiBWdWUsIG5hbWU6IHN0cmluZywgc3BsaXQ/OiBUKTogKFQgZXh0ZW5kcyB0cnVlID8gJ3Ytc2xvdCcgOiBuZXZlcikgfCAnbm9ybWFsJyB8ICdzY29wZWQnIHwgdm9pZCB7XG4gIGlmICh2bS4kc2xvdHMuaGFzT3duUHJvcGVydHkobmFtZSkgJiYgdm0uJHNjb3BlZFNsb3RzLmhhc093blByb3BlcnR5KG5hbWUpICYmICh2bS4kc2NvcGVkU2xvdHNbbmFtZV0gYXMgYW55KS5uYW1lKSB7XG4gICAgcmV0dXJuIHNwbGl0ID8gJ3Ytc2xvdCcgYXMgYW55IDogJ3Njb3BlZCdcbiAgfVxuICBpZiAodm0uJHNsb3RzLmhhc093blByb3BlcnR5KG5hbWUpKSByZXR1cm4gJ25vcm1hbCdcbiAgaWYgKHZtLiRzY29wZWRTbG90cy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgcmV0dXJuICdzY29wZWQnXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWJvdW5jZSAoZm46IEZ1bmN0aW9uLCBkZWxheTogbnVtYmVyKSB7XG4gIGxldCB0aW1lb3V0SWQgPSAwIGFzIGFueVxuICByZXR1cm4gKC4uLmFyZ3M6IGFueVtdKSA9PiB7XG4gICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZClcbiAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IGZuKC4uLmFyZ3MpLCBkZWxheSlcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdGhyb3R0bGU8VCBleHRlbmRzICguLi5hcmdzOiBhbnlbXSkgPT4gYW55PiAoZm46IFQsIGxpbWl0OiBudW1iZXIpIHtcbiAgbGV0IHRocm90dGxpbmcgPSBmYWxzZVxuICByZXR1cm4gKC4uLmFyZ3M6IFBhcmFtZXRlcnM8VD4pOiB2b2lkIHwgUmV0dXJuVHlwZTxUPiA9PiB7XG4gICAgaWYgKCF0aHJvdHRsaW5nKSB7XG4gICAgICB0aHJvdHRsaW5nID0gdHJ1ZVxuICAgICAgc2V0VGltZW91dCgoKSA9PiB0aHJvdHRsaW5nID0gZmFsc2UsIGxpbWl0KVxuICAgICAgcmV0dXJuIGZuKC4uLmFyZ3MpXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQcmVmaXhlZFNjb3BlZFNsb3RzIChwcmVmaXg6IHN0cmluZywgc2NvcGVkU2xvdHM6IGFueSkge1xuICByZXR1cm4gT2JqZWN0LmtleXMoc2NvcGVkU2xvdHMpLmZpbHRlcihrID0+IGsuc3RhcnRzV2l0aChwcmVmaXgpKS5yZWR1Y2UoKG9iajogYW55LCBrOiBzdHJpbmcpID0+IHtcbiAgICBvYmpbay5yZXBsYWNlKHByZWZpeCwgJycpXSA9IHNjb3BlZFNsb3RzW2tdXG4gICAgcmV0dXJuIG9ialxuICB9LCB7fSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNsb3QgKHZtOiBWdWUsIG5hbWUgPSAnZGVmYXVsdCcsIGRhdGE/OiBvYmplY3QgfCAoKCkgPT4gb2JqZWN0KSwgb3B0aW9uYWwgPSBmYWxzZSkge1xuICBpZiAodm0uJHNjb3BlZFNsb3RzLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgcmV0dXJuIHZtLiRzY29wZWRTbG90c1tuYW1lXSEoZGF0YSBpbnN0YW5jZW9mIEZ1bmN0aW9uID8gZGF0YSgpIDogZGF0YSlcbiAgfSBlbHNlIGlmICh2bS4kc2xvdHMuaGFzT3duUHJvcGVydHkobmFtZSkgJiYgKCFkYXRhIHx8IG9wdGlvbmFsKSkge1xuICAgIHJldHVybiB2bS4kc2xvdHNbbmFtZV1cbiAgfVxuICByZXR1cm4gdW5kZWZpbmVkXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjbGFtcCAodmFsdWU6IG51bWJlciwgbWluID0gMCwgbWF4ID0gMSkge1xuICByZXR1cm4gTWF0aC5tYXgobWluLCBNYXRoLm1pbihtYXgsIHZhbHVlKSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhZEVuZCAoc3RyOiBzdHJpbmcsIGxlbmd0aDogbnVtYmVyLCBjaGFyID0gJzAnKSB7XG4gIHJldHVybiBzdHIgKyBjaGFyLnJlcGVhdChNYXRoLm1heCgwLCBsZW5ndGggLSBzdHIubGVuZ3RoKSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNodW5rIChzdHI6IHN0cmluZywgc2l6ZSA9IDEpIHtcbiAgY29uc3QgY2h1bmtlZDogc3RyaW5nW10gPSBbXVxuICBsZXQgaW5kZXggPSAwXG4gIHdoaWxlIChpbmRleCA8IHN0ci5sZW5ndGgpIHtcbiAgICBjaHVua2VkLnB1c2goc3RyLnN1YnN0cihpbmRleCwgc2l6ZSkpXG4gICAgaW5kZXggKz0gc2l6ZVxuICB9XG4gIHJldHVybiBjaHVua2VkXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBodW1hblJlYWRhYmxlRmlsZVNpemUgKGJ5dGVzOiBudW1iZXIsIGJpbmFyeSA9IGZhbHNlKTogc3RyaW5nIHtcbiAgY29uc3QgYmFzZSA9IGJpbmFyeSA/IDEwMjQgOiAxMDAwXG4gIGlmIChieXRlcyA8IGJhc2UpIHtcbiAgICByZXR1cm4gYCR7Ynl0ZXN9IEJgXG4gIH1cblxuICBjb25zdCBwcmVmaXggPSBiaW5hcnkgPyBbJ0tpJywgJ01pJywgJ0dpJ10gOiBbJ2snLCAnTScsICdHJ11cbiAgbGV0IHVuaXQgPSAtMVxuICB3aGlsZSAoTWF0aC5hYnMoYnl0ZXMpID49IGJhc2UgJiYgdW5pdCA8IHByZWZpeC5sZW5ndGggLSAxKSB7XG4gICAgYnl0ZXMgLz0gYmFzZVxuICAgICsrdW5pdFxuICB9XG4gIHJldHVybiBgJHtieXRlcy50b0ZpeGVkKDEpfSAke3ByZWZpeFt1bml0XX1CYFxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2FtZWxpemVPYmplY3RLZXlzIChvYmo6IFJlY29yZDxzdHJpbmcsIGFueT4gfCBudWxsIHwgdW5kZWZpbmVkKSB7XG4gIGlmICghb2JqKSByZXR1cm4ge31cblxuICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5yZWR1Y2UoKG86IGFueSwga2V5OiBzdHJpbmcpID0+IHtcbiAgICBvW2NhbWVsaXplKGtleSldID0gb2JqW2tleV1cbiAgICByZXR1cm4gb1xuICB9LCB7fSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1lcmdlRGVlcCAoXG4gIHNvdXJjZTogRGljdGlvbmFyeTxhbnk+ID0ge30sXG4gIHRhcmdldDogRGljdGlvbmFyeTxhbnk+ID0ge31cbikge1xuICBmb3IgKGNvbnN0IGtleSBpbiB0YXJnZXQpIHtcbiAgICBjb25zdCBzb3VyY2VQcm9wZXJ0eSA9IHNvdXJjZVtrZXldXG4gICAgY29uc3QgdGFyZ2V0UHJvcGVydHkgPSB0YXJnZXRba2V5XVxuXG4gICAgLy8gT25seSBjb250aW51ZSBkZWVwIG1lcmdpbmcgaWZcbiAgICAvLyBib3RoIHByb3BlcnRpZXMgYXJlIG9iamVjdHNcbiAgICBpZiAoXG4gICAgICBpc09iamVjdChzb3VyY2VQcm9wZXJ0eSkgJiZcbiAgICAgIGlzT2JqZWN0KHRhcmdldFByb3BlcnR5KVxuICAgICkge1xuICAgICAgc291cmNlW2tleV0gPSBtZXJnZURlZXAoc291cmNlUHJvcGVydHksIHRhcmdldFByb3BlcnR5KVxuXG4gICAgICBjb250aW51ZVxuICAgIH1cblxuICAgIHNvdXJjZVtrZXldID0gdGFyZ2V0UHJvcGVydHlcbiAgfVxuXG4gIHJldHVybiBzb3VyY2Vcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbGxBcnJheTxUPiAobGVuZ3RoOiBudW1iZXIsIG9iajogVCkge1xuICByZXR1cm4gQXJyYXkobGVuZ3RoKS5maWxsKG9iailcbn1cblxuLyoqICBQb2x5ZmlsbCBmb3IgRXZlbnQucHJvdG90eXBlLmNvbXBvc2VkUGF0aCAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbXBvc2VkUGF0aCAoZTogRXZlbnQpOiBFdmVudFRhcmdldFtdIHtcbiAgaWYgKGUuY29tcG9zZWRQYXRoKSByZXR1cm4gZS5jb21wb3NlZFBhdGgoKVxuXG4gIGNvbnN0IHBhdGggPSBbXVxuICBsZXQgZWwgPSBlLnRhcmdldCBhcyBFbGVtZW50XG5cbiAgd2hpbGUgKGVsKSB7XG4gICAgcGF0aC5wdXNoKGVsKVxuXG4gICAgaWYgKGVsLnRhZ05hbWUgPT09ICdIVE1MJykge1xuICAgICAgcGF0aC5wdXNoKGRvY3VtZW50KVxuICAgICAgcGF0aC5wdXNoKHdpbmRvdylcblxuICAgICAgcmV0dXJuIHBhdGhcbiAgICB9XG5cbiAgICBlbCA9IGVsLnBhcmVudEVsZW1lbnQhXG4gIH1cbiAgcmV0dXJuIHBhdGhcbn1cbiJdfQ==