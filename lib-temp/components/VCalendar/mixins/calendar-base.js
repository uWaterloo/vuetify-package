// Mixins
import mixins from '../../../util/mixins';
import Colorable from '../../../mixins/colorable';
import Localable from '../../../mixins/localable';
import Mouse from './mouse';
import Themeable from '../../../mixins/themeable';
import Times from './times';
// Directives
import Resize from '../../../directives/resize';
// Util
import props from '../util/props';
import { parseTimestamp, getWeekdaySkips, createDayList, createNativeLocaleFormatter, getStartOfWeek, getEndOfWeek, getTimestampIdentifier, } from '../util/timestamp';
export default mixins(Colorable, Localable, Mouse, Themeable, Times
/* @vue/component */
).extend({
    name: 'calendar-base',
    directives: {
        Resize,
    },
    props: props.base,
    computed: {
        parsedWeekdays() {
            return Array.isArray(this.weekdays)
                ? this.weekdays
                : (this.weekdays || '').split(',').map(x => parseInt(x, 10));
        },
        weekdaySkips() {
            return getWeekdaySkips(this.parsedWeekdays);
        },
        weekdaySkipsReverse() {
            const reversed = this.weekdaySkips.slice();
            reversed.reverse();
            return reversed;
        },
        parsedStart() {
            return parseTimestamp(this.start, true);
        },
        parsedEnd() {
            const start = this.parsedStart;
            const end = this.end ? parseTimestamp(this.end) || start : start;
            return getTimestampIdentifier(end) < getTimestampIdentifier(start) ? start : end;
        },
        days() {
            return createDayList(this.parsedStart, this.parsedEnd, this.times.today, this.weekdaySkips);
        },
        dayFormatter() {
            if (this.dayFormat) {
                return this.dayFormat;
            }
            const options = { timeZone: 'UTC', day: 'numeric' };
            return createNativeLocaleFormatter(this.currentLocale, (_tms, _short) => options);
        },
        weekdayFormatter() {
            if (this.weekdayFormat) {
                return this.weekdayFormat;
            }
            const longOptions = { timeZone: 'UTC', weekday: 'long' };
            const shortOptions = { timeZone: 'UTC', weekday: 'short' };
            return createNativeLocaleFormatter(this.currentLocale, (_tms, short) => short ? shortOptions : longOptions);
        },
    },
    methods: {
        getRelativeClasses(timestamp, outside = false) {
            return {
                'v-present': timestamp.present,
                'v-past': timestamp.past,
                'v-future': timestamp.future,
                'v-outside': outside,
            };
        },
        getStartOfWeek(timestamp) {
            return getStartOfWeek(timestamp, this.parsedWeekdays, this.times.today);
        },
        getEndOfWeek(timestamp) {
            return getEndOfWeek(timestamp, this.parsedWeekdays, this.times.today);
        },
        getFormatter(options) {
            return createNativeLocaleFormatter(this.locale, (_tms, _short) => options);
        },
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsZW5kYXItYmFzZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL1ZDYWxlbmRhci9taXhpbnMvY2FsZW5kYXItYmFzZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxTQUFTO0FBQ1QsT0FBTyxNQUFNLE1BQU0sc0JBQXNCLENBQUE7QUFDekMsT0FBTyxTQUFTLE1BQU0sMkJBQTJCLENBQUE7QUFDakQsT0FBTyxTQUFTLE1BQU0sMkJBQTJCLENBQUE7QUFDakQsT0FBTyxLQUFLLE1BQU0sU0FBUyxDQUFBO0FBQzNCLE9BQU8sU0FBUyxNQUFNLDJCQUEyQixDQUFBO0FBQ2pELE9BQU8sS0FBSyxNQUFNLFNBQVMsQ0FBQTtBQUUzQixhQUFhO0FBQ2IsT0FBTyxNQUFNLE1BQU0sNEJBQTRCLENBQUE7QUFFL0MsT0FBTztBQUNQLE9BQU8sS0FBSyxNQUFNLGVBQWUsQ0FBQTtBQUNqQyxPQUFPLEVBQ0wsY0FBYyxFQUNkLGVBQWUsRUFDZixhQUFhLEVBQ2IsMkJBQTJCLEVBQzNCLGNBQWMsRUFDZCxZQUFZLEVBQ1osc0JBQXNCLEdBQ3ZCLE1BQU0sbUJBQW1CLENBQUE7QUFHMUIsZUFBZSxNQUFNLENBQ25CLFNBQVMsRUFDVCxTQUFTLEVBQ1QsS0FBSyxFQUNMLFNBQVMsRUFDVCxLQUFLO0FBQ1Asb0JBQW9CO0NBQ25CLENBQUMsTUFBTSxDQUFDO0lBQ1AsSUFBSSxFQUFFLGVBQWU7SUFFckIsVUFBVSxFQUFFO1FBQ1YsTUFBTTtLQUNQO0lBRUQsS0FBSyxFQUFFLEtBQUssQ0FBQyxJQUFJO0lBRWpCLFFBQVEsRUFBRTtRQUNSLGNBQWM7WUFDWixPQUFPLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQztnQkFDakMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRO2dCQUNmLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLElBQUksRUFBRSxDQUFDLENBQUMsS0FBSyxD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SUFBSSxDQUFDLGNBQWMsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFBO1FBQ3ZFLENBQUM7UUFDRCxZQUFZLENBQUUsT0FBZTtZQUMzQixPQUFPLDJCQUEyQixDQUNoQyxJQUFJLENBQUMsTUFBTSxFQUNYLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxFQUFFLENBQUMsT0FBTyxDQUMxQixDQUFBO1FBQ0gsQ0FBQztLQUNGO0NBQ0YsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiXG4vLyBNaXhpbnNcbmltcG9ydCBtaXhpbnMgZnJvbSAnLi4vLi4vLi4vdXRpbC9taXhpbnMnXG5pbXBvcnQgQ29sb3JhYmxlIGZyb20gJy4uLy4uLy4uL21peGlucy9jb2xvcmFibGUnXG5pbXBvcnQgTG9jYWxhYmxlIGZyb20gJy4uLy4uLy4uL21peGlucy9sb2NhbGFibGUnXG5pbXBvcnQgTW91c2UgZnJvbSAnLi9tb3VzZSdcbmltcG9ydCBUaGVtZWFibGUgZnJvbSAnLi4vLi4vLi4vbWl4aW5zL3RoZW1lYWJsZSdcbmltcG9ydCBUaW1lcyBmcm9tICcuL3RpbWVzJ1xuXG4vLyBEaXJlY3RpdmVzXG5pbXBvcnQgUmVzaXplIGZyb20gJy4uLy4uLy4uL2RpcmVjdGl2ZXMvcmVzaXplJ1xuXG4vLyBVdGlsXG5pbXBvcnQgcHJvcHMgZnJvbSAnLi4vdXRpbC9wcm9wcydcbmltcG9ydCB7XG4gIHBhcnNlVGltZXN0YW1wLFxuICBnZXRXZWVrZGF5U2tpcHMsXG4gIGNyZWF0ZURheUxpc3QsXG4gIGNyZWF0ZU5hdGl2ZUxvY2FsZUZvcm1hdHRlcixcbiAgZ2V0U3RhcnRPZldlZWssXG4gIGdldEVuZE9mV2VlayxcbiAgZ2V0VGltZXN0YW1wSWRlbnRpZmllcixcbn0gZnJvbSAnLi4vdXRpbC90aW1lc3RhbXAnXG5pbXBvcnQgeyBDYWxlbmRhclRpbWVzdGFtcCwgQ2FsZW5kYXJGb3JtYXR0ZXIgfSBmcm9tICd2dWV0aWZ5L3R5cGVzJ1xuXG5leHBvcnQgZGVmYXVsdCBtaXhpbnMoXG4gIENvbG9yYWJsZSxcbiAgTG9jYWxhYmxlLFxuICBNb3VzZSxcbiAgVGhlbWVhYmxlLFxuICBUaW1lc1xuLyogQHZ1ZS9jb21wb25lbnQgKi9cbikuZXh0ZW5kKHtcbiAgbmFtZTogJ2NhbGVuZGFyLWJhc2UnLFxuXG4gIGRpcmVjdGl2ZXM6IHtcbiAgICBSZXNpemUsXG4gIH0sXG5cbiAgcHJvcHM6IHByb3BzLmJhc2UsXG5cbiAgY29tcHV0ZWQ6IHtcbiAgICBwYXJzZWRXZWVrZGF5cyAoKTogbnVtYmVyW10ge1xuICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkodGhpcy53ZWVrZGF5cylcbiAgICAgICAgPyB0aGlzLndlZWtkYXlzXG4gICAgICAgIDogKHRoaXMud2Vla2RheXMgfHwgJycpLnNwbGl0KCcsJykubWFwKHggPT4gcGFyc2VJbnQoeCwgMTApKVxuICAgIH0sXG4gICAgd2Vla2RheVNraXBzICgpOiBudW1iZXJbXSB7XG4gICAgICByZXR1cm4gZ2V0V2Vla2RheVNraXBzKHRoaXMucGFyc2VkV2Vla2RheXMpXG4gICAgfSxcbiAgICB3ZWVrZGF5U2tpcHNSZXZlcnNlICgpOiBudW1iZXIgW10ge1xuICAgICAgY29uc3QgcmV2ZXJzZWQgPSB0aGlzLndlZWtkYXlTa2lwcy5zbGljZSgpXG4gICAgICByZXZlcnNlZC5yZXZlcnNlKClcbiAgICAgIHJldHVybiByZXZlcnNlZFxuICAgIH0sXG4gICAgcGFyc2VkU3RhcnQgKCk6IENhbGVuZGFyVGltZXN0YW1wIHtcbiAgICAgIHJldHVybiBwYXJzZVRpbWVzdGFtcCh0aGlzLnN0YXJ0LCB0cnVlKVxuICAgIH0sXG4gICAgcGFyc2VkRW5kICgpOiBDYWxlbmRhclRpbWVzdGFtcCB7XG4gICAgICBjb25zdCBzdGFydCA9IHRoaXMucGFyc2VkU3RhcnRcbiAgICAgIGNvbnN0IGVuZDogQ2FsZW5kYXJUaW1lc3RhbXAgPSB0aGlzLmVuZCA/IHBhcnNlVGltZXN0YW1wKHRoaXMuZW5kKSB8fCBzdGFydCA6IHN0YXJ0XG5cbiAgICAgIHJldHVybiBnZXRUaW1lc3RhbXBJZGVudGlmaWVyKGVuZCkgPCBnZXRUaW1lc3RhbXBJZGVudGlmaWVyKHN0YXJ0KSA/IHN0YXJ0IDogZW5kXG4gICAgfSxcbiAgICBkYXlzICgpOiBDYWxlbmRhclRpbWVzdGFtcFtdIHtcbiAgICAgIHJldHVybiBjcmVhdGVEYXlMaXN0KFxuICAgICAgICB0aGlzLnBhcnNlZFN0YXJ0LFxuICAgICAgICB0aGlzLnBhcnNlZEVuZCxcbiAgICAgICAgdGhpcy50aW1lcy50b2RheSxcbiAgICAgICAgdGhpcy53ZWVrZGF5U2tpcHNcbiAgICAgIClcbiAgICB9LFxuICAgIGRheUZvcm1hdHRlciAoKTogQ2FsZW5kYXJGb3JtYXR0ZXIge1xuICAgICAgaWYgKHRoaXMuZGF5Rm9ybWF0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRheUZvcm1hdCBhcyBDYWxlbmRhckZvcm1hdHRlclxuICAgICAgfVxuXG4gICAgICBjb25zdCBvcHRpb25zID0geyB0aW1lWm9uZTogJ1VUQycsIGRheTogJ251bWVyaWMnIH1cblxuICAgICAgcmV0dXJuIGNyZWF0ZU5hdGl2ZUxvY2FsZUZvcm1hdHRlcihcbiAgICAgICAgdGhpcy5jdXJyZW50TG9jYWxlLFxuICAgICAgICAoX3RtcywgX3Nob3J0KSA9PiBvcHRpb25zXG4gICAgICApXG4gICAgfSxcbiAgICB3ZWVrZGF5Rm9ybWF0dGVyICgpOiBDYWxlbmRhckZvcm1hdHRlciB7XG4gICAgICBpZiAodGhpcy53ZWVrZGF5Rm9ybWF0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLndlZWtkYXlGb3JtYXQgYXMgQ2FsZW5kYXJGb3JtYXR0ZXJcbiAgICAgIH1cblxuICAgICAgY29uc3QgbG9uZ09wdGlvbnMgPSB7IHRpbWVab25lOiAnVVRDJywgd2Vla2RheTogJ2xvbmcnIH1cbiAgICAgIGNvbnN0IHNob3J0T3B0aW9ucyA9IHsgdGltZVpvbmU6ICdVVEMnLCB3ZWVrZGF5OiAnc2hvcnQnIH1cblxuICAgICAgcmV0dXJuIGNyZWF0ZU5hdGl2ZUxvY2FsZUZvcm1hdHRlcihcbiAgICAgICAgdGhpcy5jdXJyZW50TG9jYWxlLFxuICAgICAgICAoX3Rtcywgc2hvcnQpID0+IHNob3J0ID8gc2hvcnRPcHRpb25zIDogbG9uZ09wdGlvbnNcbiAgICAgIClcbiAgICB9LFxuICB9LFxuXG4gIG1ldGhvZHM6IHtcbiAgICBnZXRSZWxhdGl2ZUNsYXNzZXMgKHRpbWVzdGFtcDogQ2FsZW5kYXJUaW1lc3RhbXAsIG91dHNpZGUgPSBmYWxzZSk6IG9iamVjdCB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAndi1wcmVzZW50JzogdGltZXN0YW1wLnByZXNlbnQsXG4gICAgICAgICd2LXBhc3QnOiB0aW1lc3RhbXAucGFzdCxcbiAgICAgICAgJ3YtZnV0dXJlJzogdGltZXN0YW1wLmZ1dHVyZSxcbiAgICAgICAgJ3Ytb3V0c2lkZSc6IG91dHNpZGUsXG4gICAgICB9XG4gICAgfSxcbiAgICBnZXRTdGFydE9mV2VlayAodGltZXN0YW1wOiBDYWxlbmRhclRpbWVzdGFtcCk6IENhbGVuZGFyVGltZXN0YW1wIHtcbiAgICAgIHJldHVybiBnZXRTdGFydE9mV2Vlayh0aW1lc3RhbXAsIHRoaXMucGFyc2VkV2Vla2RheXMsIHRoaXMudGltZXMudG9kYXkpXG4gICAgfSxcbiAgICBnZXRFbmRPZldlZWsgKHRpbWVzdGFtcDogQ2FsZW5kYXJUaW1lc3RhbXApOiBDYWxlbmRhclRpbWVzdGFtcCB7XG4gICAgICByZXR1cm4gZ2V0RW5kT2ZXZWVrKHRpbWVzdGFtcCwgdGhpcy5wYXJzZWRXZWVrZGF5cywgdGhpcy50aW1lcy50b2RheSlcbiAgICB9LFxuICAgIGdldEZvcm1hdHRlciAob3B0aW9uczogb2JqZWN0KTogQ2FsZW5kYXJGb3JtYXR0ZXIge1xuICAgICAgcmV0dXJuIGNyZWF0ZU5hdGl2ZUxvY2FsZUZvcm1hdHRlcihcbiAgICAgICAgdGhpcy5sb2NhbGUsXG4gICAgICAgIChfdG1zLCBfc2hvcnQpID0+IG9wdGlvbnNcbiAgICAgIClcbiAgICB9LFxuICB9LFxufSlcbiJdfQ==