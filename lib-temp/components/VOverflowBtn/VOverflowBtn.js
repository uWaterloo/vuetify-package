// Styles
import './VOverflowBtn.sass';
// Extensions
import VSelect from '../VSelect/VSelect';
import VAutocomplete from '../VAutocomplete';
import VTextField from '../VTextField/VTextField';
// Components
import VBtn from '../VBtn';
// Utilities
import { consoleWarn } from '../../util/console';
/* @vue/component */
export default VAutocomplete.extend({
    name: 'v-overflow-btn',
    props: {
        editable: Boolean,
        segmented: Boolean,
    },
    computed: {
        classes() {
            return {
                ...VAutocomplete.options.computed.classes.call(this),
                'v-overflow-btn': true,
                'v-overflow-btn--segmented': this.segmented,
                'v-overflow-btn--editable': this.editable,
            };
        },
        isAnyValueAllowed() {
            return this.editable ||
                VAutocomplete.options.computed.isAnyValueAllowed.call(this);
        },
        isSingle() {
            return true;
        },
        computedItems() {
            return this.segmented ? this.allItems : this.filteredItems;
        },
        labelValue() {
            return (this.isFocused && !this.persistentPlaceholder) || this.isLabelActive;
        },
    },
    methods: {
        genSelections() {
            return this.editable
                ? VAutocomplete.options.methods.genSelections.call(this)
                : VSelect.options.methods.genSelections.call(this); // Override v-autocomplete's override
        },
        genCommaSelection(item, index, last) {
            return this.segmented
                ? this.genSegmentedBtn(item)
                : VSelect.options.methods.genCommaSelection.call(this, item, index, last);
        },
        genInput() {
            const input = VTextField.options.methods.genInput.call(this);
            input.data = input.data || {};
            input.data.domProps.value = this.editable ? this.internalSearch : '';
            input.data.attrs.readonly = !this.isAnyValueAllowed;
            return input;
        },
        genLabel() {
            if (this.editable && this.isFocused)
                return null;
            const label = VTextField.options.methods.genLabel.call(this);
            if (!label)
                return label;
            label.data = label.data || {};
            // Reset previously set styles from parent
            label.data.style = {};
            return label;
        },
        genSegmentedBtn(item) {
            const itemValue = this.getValue(item);
            const itemObj = this.computedItems.find(i => this.getValue(i) === itemValue) || item;
            if (!itemObj.text || !itemObj.callback) {
                consoleWarn('When using "segmented" prop without a selection slot, items must contain both a text and callback property', this);
                return null;
            }
            return this.$createElement(VBtn, {
                props: { text: true },
                on: {
                    click(e) {
                        e.stopPropagation();
                        itemObj.callback(e);
                    },
                },
            }, [itemObj.text]);
        },
        updateValue(val) {
            if (val) {
                this.initialValue = this.lazyValue;
            }
            else if (this.initialValue !== this.lazyValue) {
                this.$emit('change', this.lazyValue);
            }
        },
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVk92ZXJmbG93QnRuLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvVk92ZXJmbG93QnRuL1ZPdmVyZmxvd0J0bi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxTQUFTO0FBQ1QsT0FBTyxxQkFBcUIsQ0FBQTtBQUU1QixhQUFhO0FBQ2IsT0FBTyxPQUFPLE1BQU0sb0JBQW9CLENBQUE7QUFDeEMsT0FBTyxhQUFhLE1BQU0sa0JBQWtCLENBQUE7QUFDNUMsT0FBTyxVQUFVLE1BQU0sMEJBQTBCLENBQUE7QUFFakQsYUFBYTtBQUNiLE9BQU8sSUFBSSxNQUFNLFNBQVMsQ0FBQTtBQUUxQixZQUFZO0FBQ1osT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLG9CQUFvQixDQUFBO0FBRWhELG9CQUFvQjtBQUNwQixlQUFlLGFBQWEsQ0FBQyxNQUFNLENBQUM7SUFDbEMsSUFBSSxFQUFFLGdCQUFnQjtJQUV0QixLQUFLLEVBQUU7UUFDTCxRQUFRLEVBQUUsT0FBTztRQUNqQixTQUFTLEVBQUUsT0FBTztLQUNuQjtJQUVELFFBQVEsRUFBRTtRQUNSLE9BQU87WUFDTCxPQUFPO2dCQUNMLEdBQUcsYUFBYSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7Z0JBQ3BELGdCQUFnQixFQUFFLElBQUk7Z0JBQ3RCLDJCQUEyQixFQUFFLElBQUksQ0FBQyxTQUFTO2dCQUMzQywwQkFBMEIsRUFBRSxJQUFJLENBQUMsUUFBUTthQUMxQyxDQUFBO1FBQ0gsQ0FBQztRQUNELGlCQUFpQjtZQUNmLE9BQU8sSUFBSSxDQUFDLFFBQVE7Z0JBQ2xCLGFBQWEsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQTtRQUMvRCxDQUFDO1FBQ0QsUUFBUTtZQUNOLE9BQU8sSUFBSSxDQUFBO1FBQ2IsQ0FBQztRQUNELGFBQWE7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QUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFO2dCQUNyQixFQUFFLEVBQUU7b0JBQ0YsS0FBSyxDQUFFLENBQVE7d0JBQ2IsQ0FBQyxDQUFDLGVBQWUsRUFBRSxDQUFBO3dCQUNuQixPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFBO29CQUNyQixDQUFDO2lCQUNGO2FBQ0YsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFBO1FBQ3BCLENBQUM7UUFDRCxXQUFXLENBQUUsR0FBWTtZQUN2QixJQUFJLEdBQUcsRUFBRTtnQkFDUCxJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUE7YUFDbkM7aUJBQU0sSUFBSSxJQUFJLENBQUMsWUFBWSxLQUFLLElBQUksQ0FBQyxTQUFTLEVBQUU7Z0JBQy9DLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQTthQUNyQztRQUNILENBQUM7S0FDRjtDQUNGLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8vIFN0eWxlc1xuaW1wb3J0ICcuL1ZPdmVyZmxvd0J0bi5zYXNzJ1xuXG4vLyBFeHRlbnNpb25zXG5pbXBvcnQgVlNlbGVjdCBmcm9tICcuLi9WU2VsZWN0L1ZTZWxlY3QnXG5pbXBvcnQgVkF1dG9jb21wbGV0ZSBmcm9tICcuLi9WQXV0b2NvbXBsZXRlJ1xuaW1wb3J0IFZUZXh0RmllbGQgZnJvbSAnLi4vVlRleHRGaWVsZC9WVGV4dEZpZWxkJ1xuXG4vLyBDb21wb25lbnRzXG5pbXBvcnQgVkJ0biBmcm9tICcuLi9WQnRuJ1xuXG4vLyBVdGlsaXRpZXNcbmltcG9ydCB7IGNvbnNvbGVXYXJuIH0gZnJvbSAnLi4vLi4vdXRpbC9jb25zb2xlJ1xuXG4vKiBAdnVlL2NvbXBvbmVudCAqL1xuZXhwb3J0IGRlZmF1bHQgVkF1dG9jb21wbGV0ZS5leHRlbmQoe1xuICBuYW1lOiAndi1vdmVyZmxvdy1idG4nLFxuXG4gIHByb3BzOiB7XG4gICAgZWRpdGFibGU6IEJvb2xlYW4sXG4gICAgc2VnbWVudGVkOiBCb29sZWFuLFxuICB9LFxuXG4gIGNvbXB1dGVkOiB7XG4gICAgY2xhc3NlcyAoKTogb2JqZWN0IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLlZBdXRvY29tcGxldGUub3B0aW9ucy5jb21wdXRlZC5jbGFzc2VzLmNhbGwodGhpcyksXG4gICAgICAgICd2LW92ZXJmbG93LWJ0bic6IHRydWUsXG4gICAgICAgICd2LW92ZXJmbG93LWJ0bi0tc2VnbWVudGVkJzogdGhpcy5zZWdtZW50ZWQsXG4gICAgICAgICd2LW92ZXJmbG93LWJ0bi0tZWRpdGFibGUnOiB0aGlzLmVkaXRhYmxlLFxuICAgICAgfVxuICAgIH0sXG4gICAgaXNBbnlWYWx1ZUFsbG93ZWQgKCk6IGJvb2xlYW4ge1xuICAgICAgcmV0dXJuIHRoaXMuZWRpdGFibGUgfHxcbiAgICAgICAgVkF1dG9jb21wbGV0ZS5vcHRpb25zLmNvbXB1dGVkLmlzQW55VmFsdWVBbGxvd2VkLmNhbGwodGhpcylcbiAgICB9LFxuICAgIGlzU2luZ2xlICgpOiB0cnVlIHtcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfSxcbiAgICBjb21wdXRlZEl0ZW1zICgpOiBvYmplY3RbXSB7XG4gICAgICByZXR1cm4gdGhpcy5zZWdtZW50ZWQgPyB0aGlzLmFsbEl0ZW1zIDogdGhpcy5maWx0ZXJlZEl0ZW1zXG4gICAgfSxcbiAgICBsYWJlbFZhbHVlICgpOiBib29sZWFuIHtcbiAgICAgIHJldHVybiAodGhpcy5pc0ZvY3VzZWQgJiYgIXRoaXMucGVyc2lzdGVudFBsYWNlaG9sZGVyKSB8fCB0aGlzLmlzTGFiZWxBY3RpdmVcbiAgICB9LFxuICB9LFxuXG4gIG1ldGhvZHM6IHtcbiAgICBnZW5TZWxlY3Rpb25zICgpIHtcbiAgICAgIHJldHVybiB0aGlzLmVkaXRhYmxlXG4gICAgICAgID8gVkF1dG9jb21wbGV0ZS5vcHRpb25zLm1ldGhvZHMuZ2VuU2VsZWN0aW9ucy5jYWxsKHRoaXMpXG4gICAgICAgIDogVlNlbGVjdC5vcHRpb25zLm1ldGhvZHMuZ2VuU2VsZWN0aW9ucy5jYWxsKHRoaXMpIC8vIE92ZXJyaWRlIHYtYXV0b2NvbXBsZXRlJ3Mgb3ZlcnJpZGVcbiAgICB9LFxuICAgIGdlbkNvbW1hU2VsZWN0aW9uIChpdGVtOiBhbnksIGluZGV4OiBudW1iZXIsIGxhc3Q6IGJvb2xlYW4pIHtcbiAgICAgIHJldHVybiB0aGlzLnNlZ21lbnRlZFxuICAgICAgICA/IHRoaXMuZ2VuU2VnbWVudGVkQnRuKGl0ZW0pXG4gICAgICAgIDogVlNlbGVjdC5vcHRpb25zLm1ldGhvZHMuZ2VuQ29tbWFTZWxlY3Rpb24uY2FsbCh0aGlzLCBpdGVtLCBpbmRleCwgbGFzdClcbiAgICB9LFxuICAgIGdlbklucHV0ICgpIHtcbiAgICAgIGNvbnN0IGlucHV0ID0gVlRleHRGaWVsZC5vcHRpb25zLm1ldGhvZHMuZ2VuSW5wdXQuY2FsbCh0aGlzKVxuXG4gICAgICBpbnB1dC5kYXRhID0gaW5wdXQuZGF0YSB8fCB7fVxuICAgICAgaW5wdXQuZGF0YS5kb21Qcm9wcyEudmFsdWUgPSB0aGlzLmVkaXRhYmxlID8gdGhpcy5pbnRlcm5hbFNlYXJjaCA6ICcnXG4gICAgICBpbnB1dC5kYXRhLmF0dHJzIS5yZWFkb25seSA9ICF0aGlzLmlzQW55VmFsdWVBbGxvd2VkXG5cbiAgICAgIHJldHVybiBpbnB1dFxuICAgIH0sXG4gICAgZ2VuTGFiZWwgKCkge1xuICAgICAgaWYgKHRoaXMuZWRpdGFibGUgJiYgdGhpcy5pc0ZvY3VzZWQpIHJldHVybiBudWxsXG5cbiAgICAgIGNvbnN0IGxhYmVsID0gVlRleHRGaWVsZC5vcHRpb25zLm1ldGhvZHMuZ2VuTGFiZWwuY2FsbCh0aGlzKVxuXG4gICAgICBpZiAoIWxhYmVsKSByZXR1cm4gbGFiZWxcblxuICAgICAgbGFiZWwuZGF0YSA9IGxhYmVsLmRhdGEgfHwge31cblxuICAgICAgLy8gUmVzZXQgcHJldmlvdXNseSBzZXQgc3R5bGVzIGZyb20gcGFyZW50XG4gICAgICBsYWJlbC5kYXRhLnN0eWxlID0ge31cblxuICAgICAgcmV0dXJuIGxhYmVsXG4gICAgfSxcbiAgICBnZW5TZWdtZW50ZWRCdG4gKGl0ZW06IGFueSkge1xuICAgICAgY29uc3QgaXRlbVZhbHVlID0gdGhpcy5nZXRWYWx1ZShpdGVtKVxuICAgICAgY29uc3QgaXRlbU9iaiA9IHRoaXMuY29tcHV0ZWRJdGVtcy5maW5kKGkgPT4gdGhpcy5nZXRWYWx1ZShpKSA9PT0gaXRlbVZhbHVlKSB8fCBpdGVtXG5cbiAgICAgIGlmICghaXRlbU9iai50ZXh0IHx8ICFpdGVtT2JqLmNhbGxiYWNrKSB7XG4gICAgICAgIGNvbnNvbGVXYXJuKCdXaGVuIHVzaW5nIFwic2VnbWVudGVkXCIgcHJvcCB3aXRob3V0IGEgc2VsZWN0aW9uIHNsb3QsIGl0ZW1zIG11c3QgY29udGFpbiBib3RoIGEgdGV4dCBhbmQgY2FsbGJhY2sgcHJvcGVydHknLCB0aGlzKVxuICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy4kY3JlYXRlRWxlbWVudChWQnRuLCB7XG4gICAgICAgIHByb3BzOiB7IHRleHQ6IHRydWUgfSxcbiAgICAgICAgb246IHtcbiAgICAgICAgICBjbGljayAoZTogRXZlbnQpIHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgICAgICAgIGl0ZW1PYmouY2FsbGJhY2soZSlcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSwgW2l0ZW1PYmoudGV4dF0pXG4gICAgfSxcbiAgICB1cGRhdGVWYWx1ZSAodmFsOiBib29sZWFuKSB7XG4gICAgICBpZiAodmFsKSB7XG4gICAgICAgIHRoaXMuaW5pdGlhbFZhbHVlID0gdGhpcy5sYXp5VmFsdWVcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5pbml0aWFsVmFsdWUgIT09IHRoaXMubGF6eVZhbHVlKSB7XG4gICAgICAgIHRoaXMuJGVtaXQoJ2NoYW5nZScsIHRoaXMubGF6eVZhbHVlKVxuICAgICAgfVxuICAgIH0sXG4gIH0sXG59KVxuIl19